{
  "openapi": "3.0.1",
  "info": {
    "title": "Smart Logistics API",
    "version": "1.0.0",
    "description": "OpenAPI specification for Smart Logistics backend (generated from documentation)."
  },
  "servers": [
    { "url": "http://127.0.0.1:8000", "description": "Local" }
  ],
  "paths": {
    "/": {
      "get": {
        "summary": "Health check",
        "responses": { "200": { "description": "OK" } }
      }
    },
    "/health": {
      "get": { "summary": "Health check", "responses": { "200": { "description": "OK" } } }
    },
    "/demo/health": {
      "get": { "summary": "Demo health", "responses": { "200": { "description": "OK" } } }
    },
    "/demo/predict": {
      "post": {
        "summary": "Demo prediction",
        "requestBody": {
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/DemoPredictionInput" } } }
        },
        "responses": { "200": { "description": "Prediction", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/DemoPredictionOutput" } } } } }
      }
    },
    "/api/v1/login": {
      "post": {
        "summary": "Login",
        "requestBody": { "content": { "application/json": { "schema": { "$ref": "#/components/schemas/LoginRequest" } } } },
        "responses": { "200": { "description": "Token", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/TokenResponse" } } } } }
      }
    },
    "/api/v1/upload-document": {
      "post": {
        "summary": "Upload and process document",
        "parameters": [],
        "requestBody": {
          "content": { "multipart/form-data": { "schema": { "$ref": "#/components/schemas/DocumentUploadRequest" } } }
        },
        "responses": { "200": { "description": "Upload processed", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/DocumentUploadResponse" } } } } }
      }
    },
    "/api/v1/forecast": {
      "post": {
        "summary": "Forecast materials",
        "requestBody": { "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ForecastRequest" } } } },
        "responses": { "200": { "description": "Forecast", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ForecastResponse" } } } } }
      }
    },
    "/api/v1/optimize": {
      "post": {
        "summary": "Optimize logistics",
        "requestBody": { "content": { "application/json": { "schema": { "$ref": "#/components/schemas/OptimizationRequest" } } } },
        "responses": { "200": { "description": "Optimization result", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/OptimizationResponse" } } } } }
      }
    },
    "/api/v1/federated-update": {
      "post": {
        "summary": "Federated update",
        "requestBody": { "content": { "application/json": { "schema": { "$ref": "#/components/schemas/FederatedUpdateRequest" } } } },
        "responses": { "200": { "description": "Aggregated", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/FederatedUpdateResponse" } } } } }
      }
    },
    "/api/v1/projects/{user_id}": {
      "get": {
        "summary": "List user projects",
        "parameters": [{ "name": "user_id", "in": "path", "required": true, "schema": { "type": "string" } }],
        "responses": { "200": { "description": "Project list" } }
      }
    },
    "/api/v1/project/{project_id}": {
      "get": {
        "summary": "Get project",
        "parameters": [{ "name": "project_id", "in": "path", "required": true, "schema": { "type": "string" } }],
        "responses": { "200": { "description": "Project" } }
      }
    },
    "/api/v1/statistics": {
      "get": { "summary": "Statistics", "responses": { "200": { "description": "Statistics" } } }
    },
    "/admin/reload-config": {
      "post": { "summary": "Reload config", "parameters": [{ "name": "X-Admin-Token", "in": "header", "required": true, "schema": { "type": "string" } }], "responses": { "200": { "description": "Reloaded" } } }
    }
  },
  "components": {
    "schemas": {
      "LoginRequest": { "type": "object", "properties": { "username": { "type": "string" }, "password": { "type": "string" } }, "required": ["username","password"] },
      "TokenResponse": { "type": "object", "properties": { "access_token": { "type": "string" }, "token_type": { "type": "string" }, "user_id": { "type": "string" }, "username": { "type": "string" } } },
      "DemoPredictionInput": { "type": "object", "properties": { "terrain": { "type": "string" }, "material_tons": { "type": "number" } } },
      "DemoPredictionOutput": { "type": "object", "properties": { "predicted_fuel_liters": { "type": "number" }, "predicted_labor_hours": { "type": "number" }, "total_estimated_cost_LKR": { "type": "integer" } } },
      "DocumentUploadRequest": { "type": "object", "properties": { "file": { "type": "string", "format": "binary" }, "project_name": { "type": "string" }, "location_type": { "type": "string" } }, "required": ["file"] },
      "DocumentUploadResponse": { "type": "object", "properties": { "project_id": { "type": "string" }, "message": { "type": "string" } } },
      "ForecastRequest": { "type": "object", "properties": { "material_demands": { "type": "object", "additionalProperties": { "type": "number" } } } },
      "ForecastResponse": { "type": "object", "properties": { "forecasts": { "type": "object" } } },
      "OptimizationRequest": { "type": "object" },
      "OptimizationResponse": { "type": "object" },
      "FederatedUpdateRequest": { "type": "object" },
      "FederatedUpdateResponse": { "type": "object" }
    }
  }
}